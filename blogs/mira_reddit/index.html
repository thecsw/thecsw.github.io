<!--
                 ,ae,
                ,88888e
 _____   ,a888b.9888888i   _____              _
(_____)  888888888888888  (____ \            | |
   _     88888888888888Y   _   \ \ ____  ____| |  _ ____   ____  ___  ___
  | |    '8888888888888'  | |   | / _  |/ ___) | / )  _ \ / _  )/___)/___)
 _| |_     "S888888888"   | |__/ ( ( | | |   | |< (| | | ( (/ /|___ |___ |
(_____)      "7888888Y    |_____/ \_||_|_|   |_| \_)_| |_|\____|___/(___/
                "e88j
                  "Y

-->
<!DOCTYPE html>
<html lang="en">
<head>
<link rel="canonical" href="https://sandyuraz.com/blogs/mira_reddit" type=""/>
<link rel="shortcut icon" href="https://sandyuraz.com/assets/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="https://sandyuraz.com/assets/apple-touch-icon.png" type="image/png"/>
<link rel="image_src" href="https://sandyuraz.com/assets/android-chrome-512x512.png" type="image/png"/>
<link rel="icon" href="https://sandyuraz.com/assets/favicon.ico" type=""/><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" property="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" property="generator" content="Darkness">
<meta name="author" property="author" content="sandy">
<meta name="date" property="date" content="85; 12019 H.E.">
<meta name="theme-color" property="theme-color" content="#fbebef">
<meta name="description" property="description" content="I like Go and I think it‚Äôs a great language. I built memeinvestor_bot, which was one of t...">
<meta name="robots" content="noindex, nofollow">
<meta name="og:title" property="og:title" content="Talk to Reddit with Go ‚õ≥">
<meta name="og:site_name" property="og:site_name" content="Sandy‚Äôs Website ‚õ©Ô∏è">
<meta name="og:url" property="og:url" content="https://sandyuraz.com/blogs/mira_reddit">
<meta name="og:locale" property="og:locale" content="en_GB">
<meta name="og:type" property="og:type" content="website">
<meta name="og:image" property="og:image" content="https://sandyuraz.com/blogs/mira_reddit/preview.jpg">
<meta name="og:image:alt" property="og:image:alt" content="Preview">
<meta name="og:image:type" property="og:image:type" content="image/jpg">
<meta name="og:image:width" property="og:image:width" content="1200">
<meta name="og:image:height" property="og:image:height" content="700">
<meta name="og:description" property="og:description" content="I like Go and I think it‚Äôs a great language. I built memeinvestor_bot, which was one of t...">
<meta name="twitter:card" property="twitter:card" content="summary_large_image">
<meta name="twitter:site" property="twitter:site" content="Sandy‚Äôs Website ‚õ©Ô∏è">
<meta name="twitter:creator" property="twitter:creator" content="@sandyuraz">
<meta name="twitter:image:src" property="twitter:image:src" content="https://sandyuraz.com/blogs/mira_reddit/preview.jpg">
<meta name="twitter:url" property="twitter:url" content="https://sandyuraz.com/blogs/mira_reddit">
<meta name="twitter:title" property="twitter:title" content="Talk to Reddit with Go ‚õ≥">
<meta name="twitter:description" property="twitter:description" content="I like Go and I think it‚Äôs a great language. I built memeinvestor_bot, which was one of t..."><link rel="stylesheet" type="text/css" href="https://sandyuraz.com/css/darkness.css">


<link rel="stylesheet" href="https://sandyuraz.com/scripts/highlight/styles/sandy.min.css"><script type="module">document.documentElement.classList.remove("no-js");document.documentElement.classList.add("js");</script>
<script async src="https://sandyuraz.com/scripts/time.js"></script>
<script src="https://sandyuraz.com/scripts/highlight/highlight.min.js"></script>
<script src="https://sandyuraz.com/scripts/highlight/languages/bash.min.js"></script>
<script src="https://sandyuraz.com/scripts/highlight/languages/go.min.js"></script>
<script>hljs.highlightAll();</script>


<title>Talk to Reddit with Go ‚õ≥</title>
</head>
<body class="article">

<div class="header">
<h1 class="section-1"><img id="myface" src="https://sandyuraz.com/najimi.webp" alt="avatar">Talk to Reddit with Go ‚õ≥</h1>
<div class="menu">
<span><a href="/feed.xml" class="rss-link"><img src="/assets/rss.svg" class="rss-icon"></a></span><br>
<span id="email" class="email">darkness [at] sandyuraz [dot] com</span><br>
<span id="revdate">
<a href="https://sandyuraz.com/dossier">Dossier üñã</a> | <a href="https://sandyuraz.com/books">Bookshelf üîñ</a> | <a href="https://sandyuraz.com/fortunes">Fortunes üßß</a> | <a href="https://sandyuraz.com/fortunes/kk">K.K.‚Äôs Fortunes ü¶ã</a> | <a href="https://sandyuraz.com/blogs">Go Up ‚òùÔ∏è</a> | <a href="https://sandyuraz.com/">Home üè†</a></span>
</div>
<div id="hetime" class="menu"></div>
</div>
<div class="writing">

<div class="paragraph" id="date-section" title="Tue, 26 Mar 2019">
<p>
üç∏ At least 6 years, 6 months, and 25 days ago
</p>
</div>
<div class="paragraph" >
<p>
I like Go and I think it‚Äôs a great language. I built <a href="https://github.com/thecsw/memeinvestor_bot" title="">memeinvestor_bot</a>, which was one of the interactive reddit bots on the platform at the time. So you can imagine we used quite a bit of <a href="https://github.com/praw-dev/praw" title="">praw</a>. About year and a half later, the python codebase became so disgusting and unmaintainable, where I decided to re-write the whole thing in Go. (The old &#34;let‚Äôs rewrite everything&#34; syndrome&#34;) Re-write would be too strong, re-build from scratch is what the goal was.
</p>
</div>
<div class="paragraph" >
<p>
Surely, after a couple of seconds of DuckDuckGoing, I stumbled upon <a href="https://github.com/turnage/graw" title="">graw</a>, one of the most popular Go Reddit Api Wrappers. I remember that I was just learning Go at a time and really just wanted to do something with it. Graw‚Äôs deal with <code>announcer</code> and other stuff confused me a bit. So I did what every software engineer does when it itches the wrong way. Make a new library!
</p>
</div>
<div class="paragraph" >
<p>
I present to you, <a href="https://github.com/thecsw/mira" title="">mira</a>! It‚Äôs a really playful and straight-forward library. Mira aggressively uses the dot-notation (<a href="https://github.com/jinzhu/gorm" title="">gorm</a> style) and has the simplicity of praw. Golang‚Äôs great features as goroutines are used to implement the streaming functionality. Let‚Äôs dive straight into it!
</p>
</div>
<h1 id="installing" class="section-2">Installing</h1>
<div class="paragraph" >
<p>
mira can be installed like any other go package, just run
</p>
</div></div>

<div class="coding" >
<div class="listingblock">
<pre class="highlight"><code class="language-bash" data-lang="sh">go get -u github.com/thecsw/mira</code></pre>
</div>
</div>
<div class="writing">

<h1 id="introduction" class="section-2">Introduction</h1>
<div class="paragraph" >
<p>
mira requires you to authenticate via reddit by supplying reddit tokens. Other methods of authing should be implemented. Maybe you are the chosen one?
</p>
</div>
<div class="paragraph" >
<p>
For authentication, take a look at mira‚Äôs readme, we will get to the cream of the crops and actual features.
</p>
</div>
<h1 id="basic-reddit" class="section-2">Basic reddit</h1>
<div class="paragraph" >
<p>
You can post submissions and submit/reply/edit/delete comments. You can also grab N number of submissions from any subreddit, paginate through them, and other exciting stuff! Below is some basic functionality example.
</p>
</div></div>

<div class="coding" >
<div class="listingblock">
<pre class="highlight"><code class="language-go" data-lang="go">package main

import (
    &#34;fmt&#34;

    &#34;github.com/thecsw/mira&#34;
)

// Error checking is omitted for brevity
func main() {
    // Start mira
    r, err := mira.Init(mira.ReadCredsFromFile(&#34;login.conf&#34;))
    // Make a submission
    post, err := r.Subreddit(&#34;mysubreddit&#34;).Submit(&#34;mytitle&#34;, &#34;mytext&#34;)
    // Comment on our new submission
    comment, err := r.Submission(post.GetId()).Save(&#34;mycomment&#34;)
    // Reply to our own comment
    reply, err := r.Comment(comment.GetId()).Reply(&#34;myreply&#34;)
    // Delete the reply
    r.Comment(reply.GetId()).Delete()
    // Edit the first comment
    newComment, err := r.Comment(comment.GetId()).Edit(&#34;myedit&#34;)
    // Show the comment&#39;s body
    fmt.Println(newComment.GetBody())
}</code></pre>
</div>
</div>
<div class="writing">

<h1 id="streaming" class="section-2">Streaming</h1>
<div class="paragraph" >
<p>
Streaming Reddit data is probably the most exciting part of using mira and usually the top reason of using any Reddit API wrappers. When you want to run a stream of submissions/comments/replies, mira will give you a channel where it will get populated as new streaming data becomes available.
</p>
</div>
<div class="paragraph" >
<p>
Let‚Äôs take a quick example of how we can build a reminder bot from <a href="https://turnage.gitbooks.io/graw/content/graw.html" title="">graw guide</a>. This code is originally from the graw guide, the only diffence is that it‚Äôs written to use mira instead of graw. Example done to show how those two libraries differ.
</p>
</div></div>

<div class="coding" >
<div class="listingblock">
<pre class="highlight"><code class="language-go" data-lang="go">package main

import (
    &#34;strings&#34;
    &#34;time&#34;
    &#34;github.com/thecsw/mira&#34;
)

func main() {
    r, err := mira.Init(mira.ReadCredsFromFile(&#34;login.conf&#34;))
    if err != nil {
        panic(err)
    }
    c, err := r.Subreddit(&#34;bottesting&#34;).StreamSubmissions()
    if err != nil {
        panic(err)
    }
    for {
        post := &lt;-c
        if !strings.Contains(post.GetBody(), &#34;remind me of this bot&#34;) {
            continue
        }
        go func() {
            &lt;-time.After(10 * time.Second)
            err = r.Redditor(post.GetAuthor()).Compose(
                fmt.Sprintf(&#34;Reminder: %s&#34;, post.GetTitle()),
                &#34;You&#39;ve been reminded!&#34;,
            )
            // check the error if you wish
        }()
    }
}</code></pre>
</div>
</div>
<div class="writing">
<details>
<summary>on concurrency</summary>
<hr>
<div class="paragraph" >
<p>
mira is concurrency safe! When you run <code>r.Comment(...)</code> or <code>r.Redditor(...)</code>, it adds those values to its internal channel-based queue and dequeues them when requested. If two threads or routines try to dequeue at the same time or expect something, then the data can get mingled up a bit. Only call methods in a FIFO (First-In-First-Out) style. If comment was the first to be added, then a comment-related function must consume it.
</p>
</div></details>
<div class="paragraph" >
<p>
Similar API is available for other Reddit entities and objects. For example, mira currently supports:
</p>
</div>
<div class="ulist" >
<ul class="">

<li class="l1">
<p>
<code>r.Me().StreamCommentReplies()</code>
</p>
</li>

<li class="l1">
<p>
<code>r.Me().StreamMentions()</code>
</p>
</li>

<li class="l1">
<p>
<code>r.Redditor(...).StreamComments()</code>
</p>
</li>

<li class="l1">
<p>
<code>r.Submission(...).StreamComments()</code>
</p>
</li>

<li class="l1">
<p>
<code>r.Redditor(...).StreamSubmissions()</code>
</p>
</li>

<li class="l1">
<p>
<code>r.Submission(...).StreamSubmissions()</code>
</p>
</li>
</ul>
</div>

<div class="paragraph" >
<p>
The names are very Java like and I hope they are intuitive
</p>
</div>
<h1 id="extending-mira" class="section-2">Extending mira</h1>
<div class="paragraph" >
<p>
The library only supports around 15 endpoints. Reddit has well over 50-60. Mira exposes its caller <code>Reddit.MiraRequest(httpMethod, endpoint, payload)</code> and http request handler, so you can build your own mira callers and work with them!
</p>
</div>
<div class="paragraph" >
<p>
Here is an example of how <code>r.Comment(...).Reply(subject, text)</code> is implemented:
</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">NOTE</div>
</td>
<td class="content">
you can lookup <code>checkType(...)</code> in mira‚Äôs readme
</td>
</tr>
</table>
</div></div>

<div class="coding" >
<div class="listingblock">
<pre class="highlight"><code class="language-go" data-lang="go">func (c *Reddit) Reply(text string) (models.CommentWrap, error) {
    ret := &amp;models.CommentWrap{}
    // Second return is type, which is &#34;comment&#34;
    name, _, err := c.checkType(&#34;comment&#34;)
    if err != nil {
        return *ret, err
    }
    target := RedditOauth + &#34;/api/comment&#34;
    ans, err := c.MiraRequest(&#34;POST&#34;, target, map[string]string{
        &#34;text&#34;:     text,
        &#34;thing_id&#34;: name,
        &#34;api_type&#34;: &#34;json&#34;,
    })
    json.Unmarshal(ans, ret)
    return *ret, err
}</code></pre>
</div>
</div>


</body>
</html>