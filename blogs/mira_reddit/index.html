<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="email">
<link rel="canonical" href="https://sandyuraz.com/blogs/mira_reddit/">
<meta property="og:image" content="https://sandyuraz.com/blogs/mira_reddit/preview.png">
<meta property="og:image:alt" content="Preview">
<meta property="og:image:type" content="image/png">
<meta property="og:image:width" content="1280">
<meta property="og:image:height" content="640">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="icon" href="/favicon.ico">
<meta property="og:site_name" content="Sandy&apos;s Website">
<meta property="og:url" content="https://sandyuraz.com/blogs/mira_reddit/">
<meta property="og:locale" content="en_GB">
<meta property="og:type" content="website">
<meta name="theme-color" content="#fffff4">
<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:site" content="Sandy&apos;s Website">
<meta property="twitter:creator" content="@sandyuraz">
<meta property="twitter:image:src" content="https://sandyuraz.com/blogs/mira_reddit/preview.png">
<meta property="twitter:url" content="https://sandyuraz.com/blogs/mira_reddit/">
<script type="module">document.documentElement.classList.remove("no-js");document.documentElement.classList.add("js");</script>
<script async src="/scripts/time.js"></script>
<meta property="og:title" content="Talk to Reddit with Go ‚õ≥">
<meta property="twitter:title" content="Talk to Reddit with Go ‚õ≥">
<meta property="description" content="I like Go and I think it&#8217;s a great language. I built...">
<meta property="og:description" content="I like Go and I think it&#8217;s a great language. I built...">
<meta property="twitter:description" content="I like Go and I think it&#8217;s a great language. I built...">
<title>Talk to Reddit with Go ‚õ≥</title>
</head>
<link rel="stylesheet" type="text/css" href="https://sandyuraz.com/css/asciidoctor.css">
<link rel="stylesheet" type="text/css" href="https://sandyuraz.com/css/web.css">
<body class="article">
<div id="header">
<h1><img id="myface" src="/small.png" width="100">Talk to Reddit with Go ‚õ≥</h1>
<div class="details">
<span id="author" class="author">email</span><br>
<span id="email" class="email">ctu [at] ku [dot] edu</span><br>
<span id="revdate"><a href="/about">About ü§î</a> | <a href="/books">Bookshelf üìñ</a> | <a href="/fortunes">Fortunes ü•†</a> | <a href="/">Home üè†</a></span>
</div>
<div id="hetime" class="details"></div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>March 26th, 2020</p>
</div>
<div class="paragraph">
<p>I like Go and I think it&#8217;s a great language. I built
<a href="https://github.com/thecsw/memeinvestor_bot">memeinvestor_bot</a>, which was
one of the interactive reddit bots on the platform at the time. So you
can imagine we used quite a bit of
<a href="https://github.com/praw-dev/praw">praw</a>. About year and a half later, the
python codebase became so disgusting and unmaintainable, where I decided
to re-write the whole thing in Go. (The old "let&#8217;s rewrite everything"
syndrome") Re-write would be too strong, re-build from scratch is what
the goal was.</p>
</div>
<div class="paragraph">
<p>Surely, after a couple of seconds of DuckDuckGoing, I stumbled upon
<a href="https://github.com/turnage/graw">graw</a>, one of the most popular Go Reddit
Api Wrappers. I remember that I was just learning Go at a time and
really just wanted to do something with it. Graw&#8217;s deal with <code>announcer</code>
and other stuff confused me a bit. So I did what every software engineer
does when it itches the wrong way. Make a new library!</p>
</div>
<div class="paragraph">
<p>I present to you, <a href="https://github.com/thecsw/mira">mira</a>! It&#8217;s a really
playful and straight-forward library. Mira aggressively uses the
dot-notation (<a href="https://github.com/jinzhu/gorm">gorm</a> style) and has the
simplicity of praw. Golang&#8217;s great features as goroutines are used to
implement the streaming functionality. Let&#8217;s dive straight into it!</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Adventures ‚õµ</div>
<ul class="sectlevel1">
<li><a href="#_installing">Installing</a></li>
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_basic_reddit">Basic reddit</a></li>
<li><a href="#_streaming">Streaming</a></li>
<li><a href="#_extending_mira">Extending mira</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="_installing">Installing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>mira can be installed like any other go package, just run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">go get -u github.com/thecsw/mira</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>mira requires you to authenticate via reddit by supplying reddit tokens.
Other methods of authing should be implemented. Maybe you are the chosen
one?</p>
</div>
<div class="paragraph">
<p>For authentication, take a look at mira&#8217;s readme, we will get to the
cream of the crops and actual features.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_reddit">Basic reddit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can post submissions and submit/reply/edit/delete comments. You can
also grab N number of submissions from any subreddit, paginate through
them, and other exciting stuff! Below is some basic functionality
example.</p>
</div>
<div class="paragraph">
<p><script src="https://gist.github.com/thecsw/c8bd97b96c892734eca1f945a049b834.js"></script></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_streaming">Streaming</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Streaming Reddit data is probably the most exciting part of using mira
and usually the top reason of using any Reddit API wrappers. When you
want to run a stream of submissions/comments/replies, mira will give you
a channel where it will get populated as new streaming data becomes
available.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a quick example of how we can build a reminder bot from
<a href="https://turnage.gitbooks.io/graw/content/graw.html">graw guide</a>. This
code is originally from the graw guide, the only diffence is that it&#8217;s
written to use mira instead of graw. Example done to show how those two
libraries differ.</p>
</div>
<div class="paragraph">
<p><script src="https://gist.github.com/thecsw/e2e3d2b558f943fb3f5047ed4979282d.js"></script></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
mira is not <strong>completely</strong> concurrency safe! When you run
<code>r.Comment(&#8230;&#8203;)</code> or <code>r.Redditor(&#8230;&#8203;)</code>, it adds those values to its
internal queue and dequeues them when requested. If two threads or
routines try to dequeue at the same time or expect something, then the
data can get mingled up a bit. For example, there is a
<code>r.ReplyWithID(commentID, text)</code> that makes an http request directly,
without using the internal queue, which works fine. It&#8217;s a quick
workaround that works. If you have more suggestions, I&#8217;m happy to wait
for your PR!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Similar API is available for other Reddit entities and objects. For
example, mira currently supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>r.Me().StreamCommentReplies()</code></p>
</li>
<li>
<p><code>r.Me().StreamMentions()</code></p>
</li>
<li>
<p><code>r.Redditor(&#8230;&#8203;).StreamComments()</code></p>
</li>
<li>
<p><code>r.Submission(&#8230;&#8203;).StreamComments()</code></p>
</li>
<li>
<p><code>r.Redditor(&#8230;&#8203;).StreamSubmissions()</code></p>
</li>
<li>
<p><code>r.Submission(&#8230;&#8203;).StreamSubmissions()</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The names are very Java like and I hope they are intuitive</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extending_mira">Extending mira</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The library only supports ~15 endpoints. Reddit has well over 50-60.
Mira exposes its caller
<code>Reddit.MiraRequest(httpMethod, endpoint, payload)</code> and http request
handler, so you can build your own mira callers and work with them!</p>
</div>
<div class="paragraph">
<p>Here is an example of how <code>r.Comment(&#8230;&#8203;).Reply(subject, text)</code> is
implemented:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
you can lookup <code>checkType(&#8230;&#8203;)</code> in mira&#8217;s readme
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><script src="https://gist.github.com/thecsw/25ff8b8e247b33b3cf023740ee5083bf.js"></script>
<b style="color:#ba3925">‚óºÔ∏é</b></p>
</div>
</div>
</div>
</div>
</body>
</html>